# Define a variable for classpath
CLASS_PATH = ../bin

# Define a virtual path for .class in the bin directory
vpath %.class $(CLASS_PATH)

all : librdsampjni.so

librdsampjni.so : rdsampjni.o
	gcc -Wl -shared -o $@ $<

rdsampjni.o : rdsampjni.c rdsampjni.h
	gcc -I"/usr/lib/jvm/java-7-openjdk-amd64/include" -I"/usr/lib/jvm/java-7-openjdk-amd64/include/linux" -c $< -o $@

rdsampjni.h : rdsamp.class
	javah -classpath $(CLASS_PATH) $*

rdsamp.class: 
	cd ../../src/ ;\
   javac  org/physionet/wfdb/jni/Rdsamp.java &&\
   javah org.physionet.wfdb.jni.Rdsamp &&\
   mv -v org_physionet_wfdb_jni_Rdsamp.h ../../dependencies/jni/ &&\
   rm -v ./org/physionet/wfdb/jni/Rdsamp.class &&\
   cd ../../dependencies/jni/

clean :
	rm -f rdsampjni.h rdsampjni.o librdsampjni.so 